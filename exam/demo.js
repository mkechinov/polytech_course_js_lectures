function start(){a(),b(),c(),d(),f()}function g(a){return document.getElementById(a)}function a(){g("total-sum").innerHTML=a2(ordersList)+" \u0440\u0443\u0431.",g("total-orders").innerHTML=ordersList.length,g("total-recommended").innerHTML=a2(ordersList,"recommended")+" \u0440\u0443\u0431.",g("total-typical").innerHTML=a2(ordersList,"typical")+" \u0440\u0443\u0431.",g("total-customers").innerHTML=a3(ordersList).length,g("total-without-recommended").innerHTML=a4(ordersList).length+" \u0440\u0443\u0431.",g("total-without-typical").innerHTML=a5(ordersList).length+" \u0440\u0443\u0431."}function b(){var a=new Date(2015,5,26,0,0,0),b=new Date(2015,5,28,23,59,59),c=a6(ordersList,a,b);g("period-sum").innerHTML=a2(c)+" \u0440\u0443\u0431.",g("period-total").innerHTML=c.length,g("period-customers").innerHTML=a3(c).length,g("period-recommended").innerHTML=a2(c,"recommended")+" \u0440\u0443\u0431."}function c(){for(var a=ordersList.sort(function(a,b){return a.total>b.total?-1:a.total<b.total?1:0}).slice(0,5),b="",c=null,d=null,e=0;e<a.length;e++)d=a[e],c=new Date(1e3*d.timestamp),b+="<tr><td>"+c.getDate()+"."+c.getMonth()+"."+c.getFullYear()+"</td><td>"+d.id+"</td><td>"+d.user_id+"</td><td>"+d.total+" \u0440\u0443\u0431.</td><td>"+d.typical+" \u0440\u0443\u0431.</td><td>"+d.recommended+" \u0440\u0443\u0431.</td></tr>";g("top-orders").innerHTML=b}function d(){for(var a={},b=0;b<ordersList.length;b++)"undefined"==typeof a[ordersList[b].user_id]?a[""+ordersList[b].user_id]=1:a[""+ordersList[b].user_id]++;var c=[];for(var b in a)a.hasOwnProperty(b)&&a[b]>10&&c.push(b);for(var d="",e=null,f=null,b=0;b<c.length;b++)e=c[b],f=a1(e,ordersList),d+="<tr><td>"+e+"</td><td>"+f.length+"</td></tr>";g("regular-users").innerHTML=d}function f(){g("search-button").addEventListener("click",function(){var a=g("search-field").value;if(""!=a)if(parseInt(a)!=a)alert("\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0447\u0438\u0441\u043b\u043e\u043c");else{for(var d,b=a1(a,ordersList),c="",e=0;e<b.length;e++)order=b[e],d=new Date(1e3*order.timestamp),c+="<tr><td>"+d.getDate()+"."+d.getMonth()+"."+d.getFullYear()+"</td><td>"+order.id+"</td><td>"+order.total+" \u0440\u0443\u0431.</td><td>"+order.typical+" \u0440\u0443\u0431.</td><td>"+order.recommended+" \u0440\u0443\u0431.</td></tr>";g("orders-by-user").innerHTML=c}})}function a1(a,b){for(var c=[],d=0;d<b.length;d++)b[d].user_id==a&&c.push(b[d]);return c}function a2(a,b){for(var c=0,d=0;d<a.length;d++)"typical"==b&&(c+=a[d].typical),"recommended"==b&&(c+=a[d].recommended),null==b&&(c+=a[d].total);return c}function a3(a){for(var b=[],c=0;c<a.length;c++)-1==b.indexOf(a[c].user_id)&&b.push(a[c].user_id);return b}function a4(a){for(var b=[],c=0;c<a.length;c++)0==a[c].recommended&&b.push(a[c]);return b}function a5(a){for(var b=[],c=0;c<a.length;c++)0==a[c].typical&&b.push(a[c]);return b}function a6(a,b,c){for(var d=[],e=b.valueOf()/1e3,f=c.valueOf()/1e3,g=0;g<a.length;g++)a[g].timestamp>=e&&a[g].timestamp<=f&&d.push(a[g]);return d}